#!/usr/bin/env bash
VERSION="v1.4.4" # based on remote-2.0.2

if ! [ -f config/remote -a -s config/remote ]; then
    echo "error: configure config/remote first"
    exit 1;
fi
host=$(sed 's,:.*,,'     < config/remote);
path=$(sed 's,^[^:]*:,,' < config/remote);
if [ "$host" == "" ]; then
    echo "error: config/remote should contain: [user@]host:[path/to/dir/]"
    exit 1
fi
if [ $# -lt 1 ]; then
    echo "Usage: $(basename $0) file_or_dir_for_upload_here ..."
    exit 1
fi
for src in "$@"; do
    dst=$(dirname "$src")"/"
    if [ "$dst" == "./" ]; then dst=""; fi
    if [ -d "$src" ]; then dir="-r"; else dir=""; fi
    echo scp $dir "$src" "$host:$path$dst"
    scp $dir "$src" "$host:$path$dst"
done

exit
: <<'=cut'

=encoding utf8

=head1 NAME

narada-upload - use scp to upload project files to remote host


=head1 VERSION

This document describes narada-upload version v1.4.4


=head1 USAGE

    narada-upload relative/path/file â€¦


=head1 DESCRIPTION

Script must be executed only from "project root directory".

Before using set C<config/remote> to remote address in ssh format:

    [user@]host:[path/to/dir/]


=head1 REQUIRED ARGUMENTS

None.


=head1 OPTIONS

See USAGE.


=head1 DIAGNOSTICS

None.


=head1 CONFIGURATION AND ENVIRONMENT

config/remote


=head1 DEPENDENCIES

None.


=head1 INCOMPATIBILITIES

None reported.


=head1 BUGS AND LIMITATIONS

No bugs have been reported.

Please report any bugs or feature requests to
C<bug-narada@rt.cpan.org>, or through the web interface at
L<http://rt.cpan.org>.


=head1 AUTHOR

Alex Efros C<< <powerman@cpan.org> >>


=head1 LICENSE AND COPYRIGHT

This software is Copyright (c) 2008-2015 by Alex Efros E<lt>powerman@cpan.orgE<gt>.

This is free software, licensed under:

  The MIT (X11) License


=cut
